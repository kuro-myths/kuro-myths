<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üëæ Alien Shooting Game - MYTHS</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Fira+Code:wght@400;600&display=swap');

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      background: #000;
      color: #fff;
      font-family: 'Fira Code', monospace;
      overflow: hidden;
      cursor: crosshair;
    }

    canvas {
      display: block;
    }

    .overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 10;
      background: rgba(0, 0, 0, 0.85);
    }

    .overlay.hidden { display: none; }

    .overlay h1 {
      font-family: 'Press Start 2P', cursive;
      font-size: 2rem;
      color: #ef4444;
      margin-bottom: 10px;
      text-shadow: 0 0 30px rgba(239, 68, 68, 0.6);
    }

    .overlay h2 {
      font-family: 'Press Start 2P', cursive;
      font-size: 1rem;
      color: #facc15;
      margin-bottom: 25px;
    }

    .overlay p {
      color: #9ca3af;
      margin-bottom: 15px;
      font-size: 0.85rem;
      text-align: center;
      max-width: 500px;
      line-height: 1.6;
    }

    .overlay .controls {
      color: #6b7280;
      font-size: 0.7rem;
      margin-bottom: 25px;
    }

    .overlay .controls span {
      color: #8b5cf6;
      font-weight: bold;
    }

    .btn {
      font-family: 'Press Start 2P', cursive;
      font-size: 0.7rem;
      padding: 14px 30px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
      margin: 5px;
    }

    .btn-play {
      background: linear-gradient(135deg, #ef4444, #dc2626);
      color: white;
      box-shadow: 0 4px 20px rgba(239, 68, 68, 0.4);
    }

    .btn-play:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 30px rgba(239, 68, 68, 0.6);
    }

    .btn-back {
      background: rgba(99, 102, 241, 0.15);
      color: #8b5cf6;
      border: 1px solid rgba(139, 92, 246, 0.3);
      text-decoration: none;
      display: inline-block;
      line-height: 1;
    }

    .btn-back:hover {
      background: rgba(99, 102, 241, 0.25);
    }

    .hud {
      position: fixed;
      top: 0; left: 0; right: 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 20px;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(8px);
      z-index: 5;
      font-family: 'Press Start 2P', cursive;
      font-size: 0.6rem;
    }

    .hud.hidden { display: none; }

    .hud-item {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .hud-label { color: #6b7280; }
    .hud-value { color: #ef4444; }
    .hud-lives { color: #ef4444; font-size: 0.8rem; }
    .hud-level { color: #facc15; }

    .game-over-stats {
      display: flex;
      gap: 20px;
      margin: 15px 0;
      flex-wrap: wrap;
      justify-content: center;
    }

    .stat-box {
      background: rgba(239, 68, 68, 0.1);
      border: 1px solid rgba(239, 68, 68, 0.3);
      border-radius: 10px;
      padding: 12px 20px;
      text-align: center;
    }

    .stat-label {
      font-size: 0.5rem;
      color: #6b7280;
      font-family: 'Press Start 2P', cursive;
      margin-bottom: 5px;
    }

    .stat-value {
      font-size: 0.9rem;
      color: #ef4444;
      font-family: 'Press Start 2P', cursive;
    }
  </style>
</head>
<body>

  <canvas id="gameCanvas"></canvas>

  <!-- Start Screen -->
  <div class="overlay" id="startScreen">
    <h1>üëæ ALIEN SHOOTING</h1>
    <h2>MYTHS DEFENSE</h2>
    <p>
      Alien-alien menyerang markas MYTHS dari luar angkasa! <br>
      Kamu adalah pertahanan terakhir. Tembak semua alien sebelum mereka mencapai bumi!
    </p>
    <div class="controls">
      <span>üñ±Ô∏è MOUSE</span> = Gerak &nbsp;&nbsp;
      <span>üî´ CLICK / SPACE</span> = Tembak
    </div>
    <div>
      <button class="btn btn-play" onclick="startGame()">‚ñ∂ START MISSION</button>
      <a href="https://github.com/kuro-myths/kuro-myths" class="btn btn-back">‚Ü© KEMBALI</a>
    </div>
  </div>

  <!-- Game Over Screen -->
  <div class="overlay hidden" id="gameOverScreen">
    <h1>üí• GAME OVER</h1>
    <div class="game-over-stats">
      <div class="stat-box">
        <div class="stat-label">Score</div>
        <div class="stat-value" id="finalScore">0</div>
      </div>
      <div class="stat-box">
        <div class="stat-label">Level</div>
        <div class="stat-value" id="finalLevel">1</div>
      </div>
      <div class="stat-box">
        <div class="stat-label">Kills</div>
        <div class="stat-value" id="finalKills">0</div>
      </div>
      <div class="stat-box">
        <div class="stat-label">High Score</div>
        <div class="stat-value" id="finalHighScore">0</div>
      </div>
    </div>
    <div>
      <button class="btn btn-play" onclick="startGame()">üîÑ PLAY AGAIN</button>
      <a href="https://github.com/kuro-myths/kuro-myths" class="btn btn-back">‚Ü© KEMBALI</a>
    </div>
  </div>

  <!-- HUD -->
  <div class="hud hidden" id="hud">
    <div class="hud-item">
      <span class="hud-label">SCORE:</span>
      <span class="hud-value" id="hudScore">0</span>
    </div>
    <div class="hud-item">
      <span class="hud-label">LEVEL:</span>
      <span class="hud-level" id="hudLevel">1</span>
    </div>
    <div class="hud-item">
      <span class="hud-label">LIVES:</span>
      <span class="hud-lives" id="hudLives">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</span>
    </div>
  </div>

  <script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    window.addEventListener('resize', () => {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    });

    // Game state
    let gameRunning = false;
    let score = 0;
    let highScore = parseInt(localStorage.getItem('alienHighScore') || '0');
    let level = 1;
    let lives = 3;
    let kills = 0;
    let mouseX = canvas.width / 2;
    let mouseY = canvas.height - 80;
    let shooting = false;

    // Game objects
    let player = {};
    let bullets = [];
    let aliens = [];
    let particles = [];
    let powerUps = [];
    let stars = [];
    let alienSpawnTimer = 0;
    let levelTimer = 0;

    // Star background
    function initStars() {
      stars = [];
      for (let i = 0; i < 200; i++) {
        stars.push({
          x: Math.random() * canvas.width,
          y: Math.random() * canvas.height,
          size: Math.random() * 2 + 0.5,
          speed: Math.random() * 1 + 0.3,
          alpha: Math.random()
        });
      }
    }

    function drawStars() {
      stars.forEach(s => {
        s.y += s.speed;
        s.alpha = 0.3 + Math.sin(Date.now() * 0.003 + s.x) * 0.3;
        if (s.y > canvas.height) {
          s.y = 0;
          s.x = Math.random() * canvas.width;
        }
        ctx.fillStyle = `rgba(255, 255, 255, ${s.alpha})`;
        ctx.fillRect(s.x, s.y, s.size, s.size);
      });
    }

    // Player
    function initPlayer() {
      player = {
        x: canvas.width / 2,
        y: canvas.height - 60,
        width: 40,
        height: 40,
        speed: 8,
        shootCooldown: 0,
        shootRate: 10,
        powerLevel: 1,
        shieldTimer: 0
      };
    }

    function drawPlayer() {
      const px = player.x;
      const py = player.y;

      // Engine glow
      const glow = ctx.createRadialGradient(px, py + 20, 2, px, py + 25, 20);
      glow.addColorStop(0, 'rgba(59, 130, 246, 0.8)');
      glow.addColorStop(1, 'rgba(59, 130, 246, 0)');
      ctx.fillStyle = glow;
      ctx.fillRect(px - 20, py + 10, 40, 30);

      // Ship body
      ctx.fillStyle = '#6366f1';
      ctx.beginPath();
      ctx.moveTo(px, py - 20);
      ctx.lineTo(px - 18, py + 15);
      ctx.lineTo(px - 8, py + 10);
      ctx.lineTo(px, py + 5);
      ctx.lineTo(px + 8, py + 10);
      ctx.lineTo(px + 18, py + 15);
      ctx.closePath();
      ctx.fill();

      // Cockpit
      ctx.fillStyle = '#818cf8';
      ctx.beginPath();
      ctx.moveTo(px, py - 12);
      ctx.lineTo(px - 6, py + 3);
      ctx.lineTo(px + 6, py + 3);
      ctx.closePath();
      ctx.fill();

      // Wings glow
      ctx.fillStyle = '#4f46e5';
      ctx.fillRect(px - 20, py + 8, 5, 8);
      ctx.fillRect(px + 15, py + 8, 5, 8);

      // Shield
      if (player.shieldTimer > 0) {
        ctx.strokeStyle = `rgba(56, 189, 248, ${0.4 + Math.sin(Date.now() * 0.01) * 0.3})`;
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.arc(px, py, 30, 0, Math.PI * 2);
        ctx.stroke();
      }
    }

    function updatePlayer() {
      // Smooth follow mouse
      player.x += (mouseX - player.x) * 0.12;
      player.y += (mouseY - player.y) * 0.08;

      // Clamp
      player.x = Math.max(25, Math.min(canvas.width - 25, player.x));
      player.y = Math.max(canvas.height * 0.3, Math.min(canvas.height - 30, player.y));

      if (player.shootCooldown > 0) player.shootCooldown--;
      if (player.shieldTimer > 0) player.shieldTimer--;

      // Auto-shoot when holding
      if (shooting && player.shootCooldown <= 0) {
        shoot();
      }
    }

    // Bullets
    function shoot() {
      player.shootCooldown = player.shootRate;
      const bx = player.x;
      const by = player.y - 20;

      bullets.push({ x: bx, y: by, speed: 10, damage: 1 });

      if (player.powerLevel >= 2) {
        bullets.push({ x: bx - 12, y: by + 5, speed: 10, damage: 1 });
        bullets.push({ x: bx + 12, y: by + 5, speed: 10, damage: 1 });
      }
      if (player.powerLevel >= 3) {
        bullets.push({ x: bx - 20, y: by + 10, speed: 9, damage: 1, angle: -0.1 });
        bullets.push({ x: bx + 20, y: by + 10, speed: 9, damage: 1, angle: 0.1 });
      }
    }

    function updateBullets() {
      bullets.forEach(b => {
        b.y -= b.speed;
        if (b.angle) b.x += Math.sin(b.angle) * 3;
      });
      bullets = bullets.filter(b => b.y > -10);
    }

    function drawBullets() {
      bullets.forEach(b => {
        // Bullet trail
        const gradient = ctx.createLinearGradient(b.x, b.y, b.x, b.y + 15);
        gradient.addColorStop(0, '#38bdf8');
        gradient.addColorStop(1, 'rgba(56, 189, 248, 0)');
        ctx.fillStyle = gradient;
        ctx.fillRect(b.x - 1.5, b.y, 3, 15);

        // Bullet head
        ctx.fillStyle = '#fff';
        ctx.fillRect(b.x - 1.5, b.y, 3, 5);
      });
    }

    // Aliens
    function spawnAlien() {
      const types = ['normal', 'fast', 'tank', 'zigzag'];
      const weights = [0.4, 0.25, 0.15, 0.2];

      // Adjust weights by level
      let type = 'normal';
      const r = Math.random();
      let sum = 0;
      for (let i = 0; i < types.length; i++) {
        sum += weights[i];
        if (r <= sum) { type = types[i]; break; }
      }

      const alien = {
        x: Math.random() * (canvas.width - 60) + 30,
        y: -40,
        type: type,
        phase: Math.random() * Math.PI * 2,
        hp: 1,
        maxHp: 1,
        speed: 1.5,
        points: 10,
        width: 30,
        height: 30
      };

      switch (type) {
        case 'fast':
          alien.speed = 3 + level * 0.2;
          alien.points = 15;
          alien.width = 24;
          alien.height = 24;
          break;
        case 'tank':
          alien.hp = 3 + Math.floor(level / 2);
          alien.maxHp = alien.hp;
          alien.speed = 1;
          alien.points = 30;
          alien.width = 38;
          alien.height = 38;
          break;
        case 'zigzag':
          alien.speed = 2;
          alien.points = 20;
          break;
        default:
          alien.speed = 1.5 + level * 0.15;
          break;
      }

      aliens.push(alien);
    }

    function updateAliens() {
      aliens.forEach(a => {
        a.y += a.speed;
        a.phase += 0.05;

        if (a.type === 'zigzag') {
          a.x += Math.sin(a.phase * 3) * 3;
        }

        // Check collision with player
        if (!player.shieldTimer && Math.abs(a.x - player.x) < 25 && Math.abs(a.y - player.y) < 25) {
          lives--;
          updateHudLives();
          spawnExplosion(player.x, player.y, '#6366f1');
          a.hp = 0;
          player.shieldTimer = 60; // Brief invincibility
        }
      });

      // Remove dead or off-screen aliens
      aliens = aliens.filter(a => {
        if (a.hp <= 0) return false;
        if (a.y > canvas.height + 40) {
          lives--;
          updateHudLives();
          return false;
        }
        return true;
      });
    }

    function drawAliens() {
      aliens.forEach(a => {
        ctx.save();
        ctx.translate(a.x, a.y);

        const bob = Math.sin(a.phase) * 3;

        switch (a.type) {
          case 'normal':
            // Body
            ctx.fillStyle = '#22c55e';
            ctx.beginPath();
            ctx.arc(0, bob, 15, 0, Math.PI * 2);
            ctx.fill();
            // Eyes
            ctx.fillStyle = '#000';
            ctx.fillRect(-7, bob - 4, 5, 6);
            ctx.fillRect(2, bob - 4, 5, 6);
            // Tentacles
            ctx.fillStyle = '#16a34a';
            ctx.fillRect(-12, bob + 10, 4, 8);
            ctx.fillRect(-4, bob + 12, 4, 8);
            ctx.fillRect(4, bob + 10, 4, 8);
            ctx.fillRect(8, bob + 12, 4, 6);
            break;

          case 'fast':
            ctx.fillStyle = '#facc15';
            ctx.beginPath();
            ctx.moveTo(0, bob - 12);
            ctx.lineTo(-12, bob + 10);
            ctx.lineTo(12, bob + 10);
            ctx.closePath();
            ctx.fill();
            ctx.fillStyle = '#000';
            ctx.fillRect(-4, bob - 2, 3, 4);
            ctx.fillRect(1, bob - 2, 3, 4);
            break;

          case 'tank':
            ctx.fillStyle = '#ef4444';
            ctx.fillRect(-19, bob - 15, 38, 30);
            ctx.fillStyle = '#b91c1c';
            ctx.fillRect(-15, bob - 11, 30, 22);
            ctx.fillStyle = '#fca5a5';
            ctx.fillRect(-10, bob - 6, 7, 7);
            ctx.fillRect(3, bob - 6, 7, 7);
            // HP bar
            if (a.hp < a.maxHp) {
              ctx.fillStyle = '#333';
              ctx.fillRect(-19, bob - 22, 38, 4);
              ctx.fillStyle = '#ef4444';
              ctx.fillRect(-19, bob - 22, 38 * (a.hp / a.maxHp), 4);
            }
            break;

          case 'zigzag':
            ctx.fillStyle = '#a855f7';
            ctx.beginPath();
            ctx.arc(0, bob, 13, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#c084fc';
            ctx.beginPath();
            ctx.arc(0, bob, 8, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#000';
            ctx.fillRect(-5, bob - 3, 4, 5);
            ctx.fillRect(1, bob - 3, 4, 5);
            // Spikes
            for (let i = 0; i < 6; i++) {
              const angle = (i / 6) * Math.PI * 2 + a.phase;
              ctx.fillStyle = '#a855f7';
              ctx.fillRect(Math.cos(angle) * 16 - 2, bob + Math.sin(angle) * 16 - 2, 4, 4);
            }
            break;
        }

        ctx.restore();
      });
    }

    // Collision detection
    function checkCollisions() {
      for (let i = bullets.length - 1; i >= 0; i--) {
        for (let j = aliens.length - 1; j >= 0; j--) {
          const b = bullets[i];
          const a = aliens[j];
          if (!b || !a) continue;

          if (Math.abs(b.x - a.x) < a.width / 2 + 5 && Math.abs(b.y - a.y) < a.height / 2 + 5) {
            a.hp -= b.damage;
            bullets.splice(i, 1);

            // Hit particles
            for (let k = 0; k < 3; k++) {
              particles.push({
                x: b.x,
                y: b.y,
                vx: (Math.random() - 0.5) * 4,
                vy: (Math.random() - 0.5) * 4,
                life: 15,
                maxLife: 15,
                color: '#fff',
                size: 2
              });
            }

            if (a.hp <= 0) {
              score += a.points * level;
              kills++;
              document.getElementById('hudScore').textContent = score;
              spawnExplosion(a.x, a.y, a.type === 'tank' ? '#ef4444' : a.type === 'fast' ? '#facc15' : a.type === 'zigzag' ? '#a855f7' : '#22c55e');

              // Chance to drop power-up
              if (Math.random() < 0.12) {
                spawnPowerUp(a.x, a.y);
              }

              aliens.splice(j, 1);
            }
            break;
          }
        }
      }
    }

    // Particles & Explosions
    function spawnExplosion(x, y, color) {
      for (let i = 0; i < 20; i++) {
        const angle = (i / 20) * Math.PI * 2;
        const speed = 2 + Math.random() * 4;
        particles.push({
          x, y,
          vx: Math.cos(angle) * speed,
          vy: Math.sin(angle) * speed,
          life: 25 + Math.random() * 15,
          maxLife: 40,
          color: color,
          size: 2 + Math.random() * 3
        });
      }
    }

    function updateParticles() {
      particles.forEach(p => {
        p.x += p.vx;
        p.y += p.vy;
        p.vx *= 0.96;
        p.vy *= 0.96;
        p.life--;
      });
      particles = particles.filter(p => p.life > 0);
    }

    function drawParticles() {
      particles.forEach(p => {
        const alpha = p.life / p.maxLife;
        ctx.globalAlpha = alpha;
        ctx.fillStyle = p.color;
        ctx.fillRect(p.x - p.size / 2, p.y - p.size / 2, p.size, p.size);
      });
      ctx.globalAlpha = 1;
    }

    // Power-ups
    function spawnPowerUp(x, y) {
      const types = ['weapon', 'shield', 'life'];
      const type = types[Math.floor(Math.random() * types.length)];
      powerUps.push({
        x, y,
        type: type,
        speed: 1.5,
        phase: 0
      });
    }

    function updatePowerUps() {
      powerUps.forEach(p => {
        p.y += p.speed;
        p.phase += 0.08;

        // Check player collision
        if (Math.abs(p.x - player.x) < 25 && Math.abs(p.y - player.y) < 25) {
          switch (p.type) {
            case 'weapon':
              player.powerLevel = Math.min(3, player.powerLevel + 1);
              player.shootRate = Math.max(5, player.shootRate - 2);
              break;
            case 'shield':
              player.shieldTimer = 180;
              break;
            case 'life':
              lives = Math.min(5, lives + 1);
              updateHudLives();
              break;
          }
          spawnExplosion(p.x, p.y, '#38bdf8');
          p.collected = true;
        }
      });
      powerUps = powerUps.filter(p => !p.collected && p.y < canvas.height + 30);
    }

    function drawPowerUps() {
      powerUps.forEach(p => {
        ctx.save();
        ctx.translate(p.x, p.y);
        const pulse = 1 + Math.sin(p.phase) * 0.15;
        ctx.scale(pulse, pulse);

        // Glow
        const glow = ctx.createRadialGradient(0, 0, 5, 0, 0, 18);

        switch (p.type) {
          case 'weapon':
            glow.addColorStop(0, 'rgba(251, 146, 60, 0.5)');
            glow.addColorStop(1, 'rgba(251, 146, 60, 0)');
            ctx.fillStyle = glow;
            ctx.fillRect(-18, -18, 36, 36);
            ctx.fillStyle = '#fb923c';
            ctx.font = '16px serif';
            ctx.textAlign = 'center';
            ctx.fillText('‚ö°', 0, 6);
            break;
          case 'shield':
            glow.addColorStop(0, 'rgba(56, 189, 248, 0.5)');
            glow.addColorStop(1, 'rgba(56, 189, 248, 0)');
            ctx.fillStyle = glow;
            ctx.fillRect(-18, -18, 36, 36);
            ctx.fillStyle = '#38bdf8';
            ctx.font = '16px serif';
            ctx.textAlign = 'center';
            ctx.fillText('üõ°Ô∏è', 0, 6);
            break;
          case 'life':
            glow.addColorStop(0, 'rgba(239, 68, 68, 0.5)');
            glow.addColorStop(1, 'rgba(239, 68, 68, 0)');
            ctx.fillStyle = glow;
            ctx.fillRect(-18, -18, 36, 36);
            ctx.fillStyle = '#ef4444';
            ctx.font = '16px serif';
            ctx.textAlign = 'center';
            ctx.fillText('‚ù§Ô∏è', 0, 6);
            break;
        }

        ctx.restore();
      });
    }

    // HUD
    function updateHudLives() {
      const hearts = '‚ù§Ô∏è'.repeat(Math.max(0, lives));
      document.getElementById('hudLives').textContent = hearts || 'üíÄ';
    }

    // Level system
    function checkLevelUp() {
      const newLevel = Math.floor(kills / 15) + 1;
      if (newLevel > level) {
        level = newLevel;
        document.getElementById('hudLevel').textContent = level;

        // Level-up effect
        for (let i = 0; i < 40; i++) {
          particles.push({
            x: canvas.width / 2,
            y: canvas.height / 2,
            vx: (Math.random() - 0.5) * 10,
            vy: (Math.random() - 0.5) * 10,
            life: 40,
            maxLife: 40,
            color: '#facc15',
            size: 3
          });
        }
      }
    }

    // Input
    canvas.addEventListener('mousemove', e => {
      mouseX = e.clientX;
      mouseY = e.clientY;
    });

    canvas.addEventListener('mousedown', () => { shooting = true; });
    canvas.addEventListener('mouseup', () => { shooting = false; });

    document.addEventListener('keydown', e => {
      if (e.code === 'Space') {
        e.preventDefault();
        shooting = true;
      }
    });
    document.addEventListener('keyup', e => {
      if (e.code === 'Space') shooting = false;
    });

    // Touch support
    canvas.addEventListener('touchstart', e => {
      e.preventDefault();
      shooting = true;
      const t = e.touches[0];
      mouseX = t.clientX;
      mouseY = t.clientY;
    });
    canvas.addEventListener('touchmove', e => {
      e.preventDefault();
      const t = e.touches[0];
      mouseX = t.clientX;
      mouseY = t.clientY;
    });
    canvas.addEventListener('touchend', () => { shooting = false; });

    // Main Game Loop
    function gameLoop() {
      if (!gameRunning) return;

      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Background
      drawStars();

      // Spawn aliens
      alienSpawnTimer++;
      const spawnRate = Math.max(20, 60 - level * 5);
      if (alienSpawnTimer >= spawnRate) {
        spawnAlien();
        alienSpawnTimer = 0;
      }

      // Updates
      updatePlayer();
      updateBullets();
      updateAliens();
      checkCollisions();
      checkLevelUp();
      updateParticles();
      updatePowerUps();

      // Draws
      drawBullets();
      drawAliens();
      drawPowerUps();
      drawPlayer();
      drawParticles();

      // Check game over
      if (lives <= 0) {
        gameOver();
        return;
      }

      requestAnimationFrame(gameLoop);
    }

    function startGame() {
      document.getElementById('startScreen').classList.add('hidden');
      document.getElementById('gameOverScreen').classList.add('hidden');
      document.getElementById('hud').classList.remove('hidden');

      // Reset
      score = 0;
      level = 1;
      lives = 3;
      kills = 0;
      bullets = [];
      aliens = [];
      particles = [];
      powerUps = [];
      alienSpawnTimer = 0;
      shooting = false;

      document.getElementById('hudScore').textContent = '0';
      document.getElementById('hudLevel').textContent = '1';
      updateHudLives();

      initStars();
      initPlayer();

      gameRunning = true;
      gameLoop();
    }

    function gameOver() {
      gameRunning = false;

      if (score > highScore) {
        highScore = score;
        localStorage.setItem('alienHighScore', highScore);
      }

      document.getElementById('hud').classList.add('hidden');
      document.getElementById('gameOverScreen').classList.remove('hidden');
      document.getElementById('finalScore').textContent = score;
      document.getElementById('finalLevel').textContent = level;
      document.getElementById('finalKills').textContent = kills;
      document.getElementById('finalHighScore').textContent = highScore;
    }

    // Draw idle background
    initStars();
    function idleLoop() {
      if (gameRunning) return;
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      drawStars();
      requestAnimationFrame(idleLoop);
    }
    idleLoop();
  </script>
</body>
</html>
